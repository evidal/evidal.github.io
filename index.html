
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Le Blog d'Eric Vidal</title>
  <meta name="author" content="Eric Vidal">

  
  <meta name="description" content="">
  

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="http://fonts.googleapis.com/css?family=Allan:bold" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Cardo" rel="stylesheet" type="text/css">

  
  <link rel="canonical" href="http://evidal.github.io">
  <link href="/favicon.png" rel="icon">
  
  <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
  <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
  <link href="/stylesheets/elusive-webfont.css" rel="stylesheet">

  
  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">

  <script src="/javascripts/libs/jquery.js"></script>
  <script src="/javascripts/libs/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/bootstrap.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Le Blog d'Eric Vidal" type="application/atom+xml">
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
  

</head>

<body   >
  <div class="container-narrow">  
	  <div class="container">
	  	<div class="header">
  <div class="container">
    <img src="/images/coffee-cup-48.png" class="headerct">
    <a class="headerct" href="/">Le Blog d'Eric Vidal</a>
  </div>
  <nav role="navigation"><div class="navbar navbar-inverse container">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <!-- <a class="brand" href="/">Le Blog d'Eric Vidal</a> -->

      <div class="nav-collapse">
        <ul class="nav">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/cv">CV</a></li>
</ul>


        <ul class="nav pull-right" data-subscription="rss">
          <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><i class="icon-rss"></i></a></li>
          
        </ul>

        
          <form class="pull-right navbar-search" action="http://google.com/search" method="get">
            <fieldset role="search">
              <input type="hidden" name="q" value="site:evidal.github.io" />
              <input class="search-query" type="text" name="q" results="0" placeholder="Search"/>
            </fieldset>
          </form>
        
      </div>
    </div>
  </div>
</div>

      <!-- <div class="">
        <ul class="nav nav-pills pull-right">
          <li class="active"><a href="#">Home</a></li>
          <li><a href="/">Blog</a></li>
          <li><a href="/blog/archives">Archives</a></li>
        </ul>
        <h3 class="muted">
          <img src="/images/coffee-cup-48.png" class="headerct">
          <a class="headerct" href="/">Le Blog d'Eric Vidal</a>
        </h3>
      </div> -->
</nav>
</div>

	    <div class="row">
	      <div class="span9">
  
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2013/02/24/angular.js-et-yeoman/">Angular.js Et Yeoman</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-24T00:00:00+01:00" pubdate data-updated="true">24/02/13</time>
        
         | <a href="/blog/2013/02/24/angular.js-et-yeoman/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Je suis allé au <a href="http://lyonjs.org/">LyonJS</a> ce 18 février 2013, c&#8217;était mon premier User Group JS&hellip; et je pense que je reviendrais. Les sujets présentés étaient <a href="http://angularjs.org/">Angular.js</a>, <a href="http://yeoman.io/">Yeoman</a> et un lightning talk sur les Web Workers.</p>

<p>Premier contact donc avec Angular avec la présentation de <a href="https://twitter.com/ThierryChatel">Thierry Chatel</a> qui nous fait un petit historique sur Angular et qui nous expose les bases du framework.</p>

<p>Sa présentation est suivie d&#8217;une super séance de live coding faite par <a href="https://twitter.com/Swiip">Matthieu Lux</a>. Yeoman est un outil permettant de gérer les dépendances de ses projets Javascript. Il intégre 3 outils:</p>

<ul>
<li>Yeoman qui permet d&#8217;initialiser un projet JS en configurant des outils standard JS</li>
<li>Grunt, un outil de build, preview et test JS préconfiguré par yeoman</li>
<li>Bower, l&#8217;outil de gestion de dépendance intégré à Yeoman</li>
</ul>


<p>Matthieu installe donc Yeoman et initie un projet Angular à l&#8217;aide de Yeoman. Ces outils pour cette présentation sont IntelliJ IDEA, une console bash et Google Chrome. Pour la partie service, il utilise une base Mongo DB hébergée chez <a href="https://www.mongohq.com/">Mongo HQ</a> &ldquo;attaquée&rdquo; via des services REST préalablement développés et déployés.</p>

<p>Le projet est initialisé simplement avec la commande yeoman. L&#8217;outil pose un certain nombre de questions (Bootstrap/pas Boostrap, Compass/pas Compass, etc&hellip;). Matthieu ajoute ensuite la dépendance vers Angular (même si un initialiseur Angular existe) pour montrer comment on peut ajouter des éléments à un projet existant.</p>

<p>Une fois le projet initialisé il lance le serveur Web intégré et il peut vérifier le résultat dans Chrome. La nature d&#8217;Angular fait que la page est mise à jour en continu, donc tout changement fait au niveau du HTML est immédiatement pris en compte sur le navigateur. C&#8217;est assez plaisant car avec 2 écrans pour développer, on peut avoir un écran avec le code source et un écran avec le résultat avec un affichage temps réel.</p>

<p>Matthieu a réalisé en 1 heure un projet permettant de gérer une liste avec création/édition/suppression d&#8217;items. Ce qui m&#8217;a plu c&#8217;est la concision et la clarté avec laquelle est structuré ce petit exemple. Le même code écrit uniquement avec JQuery aurait été beaucoup plus volumineux et certainement moins clair.</p>

<p>Bonne cession qui m&#8217;a en tout cas donné envie de me plonger un peu plus sérieusement sur tous ces frameworks Javascript.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/10/24/mon-premier-sprite-en-HTML-5/">Mon Premier Sprite en HTML 5</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-24T00:00:00+02:00" pubdate data-updated="true">24/10/12</time>
        
         | <a href="/blog/2012/10/24/mon-premier-sprite-en-HTML-5/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Bon ça traîne depuis un petit moment sur mon disque mais voilà ma première utilisation du composant HTML5 canvas.</p>

<p>C&#8217;est le petit Zangief qui a été mis à contribution.</p>

<p>Le source est disponible sur GitHub sous mon projet <a href="https://github.com/evidal/HTML5tests">HTML5tests</a>.</p>

<p>Le resultat de ce test est <a href="http://htmlpreview.github.com/?https://github.com/evidal/HTML5tests/blob/master/canvas.html">ici</a></p>

<iframe src="http://htmlpreview.github.com/?https://github.com/evidal/HTML5tests/blob/master/canvas.html" width="100%" height="600px"></iframe>


<p>Bizarrement je m&#8217;attendais à ce que ce soit beaucoup plus difficile pour avoir un résultat fluide. N&#8217;étant pas un artiste, ce qui a été le plus long a été de trouver les sprites. Du coup ça m&#8217;a donné plein d&#8217;idées et j&#8217;ai téléchargé tout un tas d&#8217;autres sprites (dispo dans mon projet GitHUB <a href="https://github.com/evidal/HTML5tests">HTML5tests</a>).</p>

<p>Je ferai une mise à jour de l&#8217;article avec les différents liens qui m&#8217;ont permis d&#8217;atteindre ce résultat.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/10/18/elastic-search/">Elastic Search</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-18T00:00:00+02:00" pubdate data-updated="true">18/10/12</time>
        
         | <a href="/blog/2012/10/18/elastic-search/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Elastic Search est un moteur de recherche basé sur Lucene expérimenté par la société
dans laquelle je travaille depuis un certain temps. Ce moteur était présenté
dans le cadre du Lyon JUG par <a href="http://dev.david.pilato.fr/">David Pilato</a> et <a href="https://twitter.com/tlrx">Tanguy Leroux</a>.</p>

<p>L&#8217;interview pre-JUG par les Duchess est disponible <a href="http://www.duchess-france.org/rencontre-avec-david-pilato-sur-elastic-search/">ici</a>.
La présentation elle même est disponible <a href="http://t.co/piqUOkTE">ici</a>.</p>

<p>Je ne vais pas réexpliquer le fonctionnement d&#8217;Elastic Search car de nombreux articles le font déjà (et notamment la présentation de David Pilato).
De notre coté nous avons sélectionner Elastic Serach pour plusierus fonctionnalités importantes pour nous:</p>

<ul>
<li>Nos logicielles sont déployés sur des clusters pour avoir un fonctionnement Actif-Actif. C&#8217;est une des fonctionnalités de base d&#8217;Elastic Search.</li>
<li>Nous manipulons des données très volumineuses en terme de nombre (plusieurs dizaines, voir centaines de millions). Elastic Serach est &ldquo;taillé&rdquo; pour ce volume.</li>
<li>La navigation par &ldquo;Facet&rdquo; qui nous est nécéssaire</li>
</ul>


<p>Cependant nous en sommes encore au stade de l&#8217;étude et nous n&#8217;avons pas encore de vrai déploiement utilisant cette technologie.</p>

<p>Voilà quelques points importants que j&#8217;ai noté pour mémoire:</p>

<ul>
<li>Sécurisation,

<ul>
<li>pour l’instant Elastic Search n’est pas sécurisé. Il est possible qu’il le devienne mais pas dans les toutes prochaines versions.</li>
<li>1ère stratégie : mettre un apache devant et « jouer » avec les règles d&#8217;un firewall (DMZ)
<strong> ajouter une couche http authent pour l&#8217;accès
</strong> utiliser des filtres pour restreindre l’utilisation de certaines commande (comme DELETE, PUT)
** en séparant les index, on peut spécifier des chemins d’accès à des données et gérer des profils</li>
<li>2ème stratégie, utiliser le plugin suivant <a href="https://github.com/sonian/elasticsearch-jetty">https://github.com/sonian/elasticsearch-jetty</a> (solution recommandé uniquement par 1 des speakers)</li>
</ul>
</li>
<li>Cluster et déploiement

<ul>
<li>Les préconisation de déploiement sont de 1 shard par serveur (1 shard = 1 instance de Lucene) + 1 replica</li>
<li>/!\ on ne peut pas changer le nombre de shards une fois qu’un index est crée</li>
<li>Les intervenants recommandent de bien dimensionner son cluster dès le départ, rajouter un nouveau membre au cluster est assez lourd en terme de consommation sur des indexes volumineux</li>
<li>Il est préférable d’effectuer les montées de version à froid (même si des procédures à chaud existent)</li>
<li>D’après le concepteur d’Elastic Search si une requête met plus de 100ms, c’est que la plate-forme est sous dimmensionné.</li>
</ul>
</li>
<li>Il existe une JDBC River qui permet automatiquement d’indexer une table au fil de l’eau

<ul>
<li><a href="https://github.com/jprante/elasticsearch-river-jdbc">https://github.com/jprante/elasticsearch-river-jdbc</a></li>
</ul>
</li>
<li>Un projet d’indexation de Log existe déjà

<ul>
<li><a href="http://logstash.net/">http://logstash.net/</a></li>
</ul>
</li>
<li>Déploiement de références

<ul>
<li>Des déploiements existent avec 25 noeuds indexant plus d’1 milliard de documents</li>
<li>Le premier intervenant (David Pilato) a travaillé sur un projet indexant 500.000 documents des douanes françaises. Le projet tournait sur 3 serveurs low end (CPU 2 cores, mémoire 4GB)</li>
<li>Le deuxième (Tanguy Leroux) a travaillé pour un assureur pour indexer 20.000.000 documents (chaque document était l’équivalent d’une page word). Le projet tournait sur 4 serveurs low end (CPU 2 cores, mémoire 4GB)</li>
</ul>
</li>
<li>Utiliser Elastic Search comme un entrepot de données

<ul>
<li>le créateur le déconseille pour l&#8217;instant mais ce sera peut-être possible à l&#8217;avenir.</li>
<li>Un des intervenant a indiqué qu&#8217;il connaissait un projet utilisant Elastic Search comme base de données principale. Mais dans ce cas il fallait faire une croix sur les transactions et autres fonctionnalités d&#8217;une base de données.</li>
</ul>
</li>
</ul>


<p>Session très intéréssante et speakers disponibles pour répondre aux questions !</p>

<p>Merci le Lyon JUG.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/07/24/sophisme-et-spring/">Sophisme Et Spring</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-07-24T00:00:00+02:00" pubdate data-updated="true">24/07/12</time>
        
         | <a href="/blog/2012/07/24/sophisme-et-spring/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Une petite note en passant suite aux commentaires d&#8217;un fournisseur (qui m&#8217;énerve).</p>

<p>Ce fournisseur donc aime bien travailler avec Spring, ils sont à l&#8217;aise avec et travaille plutôt bien dessus.
Ces gens là donc sont en train de récupérer un logiciel pour en assurer sa maintenance et sa roadmap.
Une de leur mission et d&#8217;améliorer les tests unitaires qui sont pour l&#8217;instant faible, et la c&#8217;est le drame (avec le ton d&#8217;Enquêtes exclusives ).</p>

<p>Voila leur argumentaire:</p>

<ul>
<li>Spring c&#8217;est super testable</li>
<li>Votre application utilise des EJB (NB: JEE 1.5, EJB 3.1)</li>
<li>Votre application n&#8217;est pas testable, il faut tout injecter à la main, c&#8217;est trop compliqué.</li>
<li>Vous auriez dû utiliser Spring</li>
</ul>


<p>AAaaaaah mais que ça me fatigue/énerve.</p>

<p>Disclaimer : Je considère que le système d&#8217;injection de Spring ne sert à rien dans un serveur d&#8217;application depuis JEE 1.5.
Après pour les autres éléments &ldquo;Springuiens&rdquo;, c&#8217;est une autre histoire.
D&#8217;autant plus que l&#8217;utilisation de JEE ou Spring n&#8217;est pas exclusive !</p>

<p>Quand j&#8217;entends des arguments du genre Spring c&#8217;est mieux parce que c&#8217;est plus simple à tester, ça me fait juste bondir. C&#8217;est un argument moisi.
Il serait beaucoup plus honnête et acceptable de dire &ldquo;je suis plus à l&#8217;aise avec Spring qu&#8217;avec JEE 1.5, alors s&#8217;il te plait laisse moi utiliser Spring&rdquo;.
Ça je pourrais l&#8217;entendre. Le reste, c&#8217;est juste de l&#8217;incompétence.</p>

<p>Pour mémoire &ndash;> <a href="http://www.adam-bien.com/roller/abien/entry/unit_testing_ejb_3_1">http://www.adam-bien.com/roller/abien/entry/unit_testing_ejb_3_1</a></p>

<p>ou alors</p>

<p><a href="http://www.jboss.org/arquillian.html">http://www.jboss.org/arquillian.html</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/06/07/Groovy-2.0-Quoi-de-neuf-doc/">Groovy 2.0 : Quoi De Neuf Doc</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-07T00:00:00+02:00" pubdate data-updated="true">07/06/12</time>
        
         | <a href="/blog/2012/06/07/Groovy-2.0-Quoi-de-neuf-doc/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>J&#8217;ai assisté le 16 juin dernier à la présentation Groovy 2.0 par
<a href="http://glaforge.appspot.com/">Guillaume Laforge</a> au
<a href="http://www.lyonjug.org/">Lyon JUG</a>.
J&#8217;ai découvert <a href="http://groovy.codehaus.org/">Groovy</a> il n&#8217;y a pas si longtemps,
c&#8217;était il y a un peu plus de 2 ans. Le but de son utilisation dans notre
application était d&#8217;écrire des règles évaluées à la volée. Finalement une autre
solution a été choisie par l&#8217;équipe mais j&#8217;ai beaucoup aimé la simplicité du
langage.
Depuis ce premier contact, je l&#8217;utilise régulièrement pour la manipulation de
fichier (un peu comme un super script), comme support via grails pour des démos
ou POC et aussi pour ce blog qui est développé avec
<a href="http://gaelyk.appspot.com/">Gaelyk</a>. C&#8217;est donc un langage que j&#8217;apprécie.</p>

<p>La présentation de <a href="http://glaforge.appspot.com/">Guillaume Laforge</a> se déroulait en 2 temps:</p>

<ul>
<li>un rappel des fonctionnalité actuelles de Groovy 1.8</li>
<li>une présentation des nouveautés Groovy 2.0</li>
</ul>


<p>Cette présentation est accessible sur Slideshare
<a href="http://www.slideshare.net/glaforge/groovy-20-devoxx-france-2012">ici</a>.</p>

<p>Honnêtement le rappel des fonctionnalités était salutaire. Comme j&#8217;utilise
Groovy comme un meilleur <a href="http://java.com/fr/">Java</a>, il y a certains aspects
du langage que je n&#8217;utilise pas comme GPars (un équivalent de <a href="http://akka.io/">AKKA</a>)
ou trop partiellement comme le commande chain ou je me limite par reflexe.
La présentation m&#8217;a clairement montré que j&#8217;avais besoin de me plonger
sérieusement dans la doc de Groovy pour en exploiter toutes ces facets
(ou du moins mieux les connaitre).</p>

<p>Concernant la version 2.0 de Groovy, les évolutions concerne moins le langage
que la plate-forme. Cette nouvelle version est modulaire, c&#8217;est à dire qu&#8217;au lieu
d&#8217;avoir un groovy-all.jar (qui existe encore), on peut prendre d&#8217;autres jars qui
sont des sous modules de Groovy. Le but de cette modularité est de faciliter
l&#8217;utilisation de groovy dans des applications mobiles par exemple, car on va
réduire la taille de l&#8217;application.
Le reste des évolutions concerne l&#8217;adaptation de Groovy aux nouvelles
fonctionnalités de Java 7 permettant d&#8217;intégrer les nouveautés du langage Java
(<a href="http://openjdk.java.net/projects/coin/">projet Coin</a>) et d&#8217;améliorer les
performances de Groovy. Les performances sont maintenant très proches de Java.
Enfin le compilateur Groovy a été amélioré pour être plus râleur et signaler
les erreurs de compilations qui n&#8217;apparaissaient avant qu&#8217;à l&#8217;exécution. Il
permet également maintenant de faire de compilation statique du code.</p>

<p>J&#8217;ai beaucoup aimé cette session et je vais essayer d&#8217;appliquer tout ça notamment
en refondant ce site. Sa vitesse ne me satisfait pas pour l&#8217;instant. Quand à Groovy
le langage est clairement facile et puissant. Sa syntaxe proche de Java fait qu&#8217;il
est très simple à apprendre et petit à petit, avec l&#8217;experience, on incorpore
les spécificités du langage : closure, GDK, JSon, parsers&hellip; Je n&#8217;ai jamais fait de
Scala (qui a le même âge que Groovy) ou de Clojure (plus jeune) mais quand je lis
des sources de ces langages, leur lecture ne me semble pas simple. Avec Groovy,
même quand j&#8217;ignorais les rudiments du langage, le lecture des exemples était
facile pour moi.</p>

<p>Bref, vive Groovy !</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/04/28/Mix-IT-2012/">Mix-IT 2012</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-28T00:00:00+02:00" pubdate data-updated="true">28/04/12</time>
        
         | <a href="/blog/2012/04/28/Mix-IT-2012/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>J&#8217;étais avant-hier à Mix-IT 2012 er j&#8217;ai passé un très bon moment. Bravo à l&#8217;organisation pour avoir fait intervenir des speakers de qualité dans un cadre agréable pour seulement 30€. J&#8217;ai participé aux keynotes de bienvenu et à 6 conférences : Social Architecture, Lean Startup, lightning talks, Development Process at Google, Phone Gap et Zero MQ. Je n&#8217;ai malheureusement pas pu assister à la keynote finale de Pamela Fox.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/04/28/Mix-IT-2012/">Lire la suite&rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/02/21/Maitriser-sa-production/">Ma&icirc;triser Sa Production</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-21T00:00:00+01:00" pubdate data-updated="true">21/02/12</time>
        
         | <a href="/blog/2012/02/21/Maitriser-sa-production/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Un blog un peu court pour expliquer à quel point il est important que les équipes de production soient formées aux environnements d&#8217;exécution qu’elles utilisent. La plupart des administrateurs avec qui j’ai travaillé sont vraiment très bon dans le domaine système, il est beaucoup plus rare qu’ils connaissent aussi nos environnements d&#8217;exécution comme JBoss par exemple.</p>

<p>Bien sur il arrive que les équipes de développement assurent des formations sur l’application que les administrateurs vont déployer. Mais si tous les aspects purement “administratif” sont au mieux passés rapidement, ils sont souvent ignorés.</p>

<p>Et quand on donne des outils aussi puissant qu’un serveur d’application à des administrateurs mal formés, on peut aboutir à des catastrophes. J’ai un exemple récent dans une société dont je tairai le nom d’un serveur JBoss ayant une adresse IP public. Ce serveur avait été installé pour une démo brut de décoffrage, sans paramétrage. Ce qui fait que la console JMX était accessible sans mot de passe, ainsi que la console d’admin qui avait les mots de passe par défaut. Ce serveur c’est fait attaqué. L’attaque a été construite comme cela:</p>

<ul>
<li>scan des ports de la machine</li>
<li>repérage et identification d’un serveur JBoss</li>
<li>repérage que la faille décrite <a href="http://eromang.zataz.com/2011/10/25/jboss-worm-analysis-in-details/">ici</a> fonctionnait bien</li>
</ul>


<p>Et voila un serveur ultra puissant à la merci de pirates.</p>

<p>Ce qu’il faut retenir de cette histoire, c’est qu’un serveur d&#8217;application n’est pas un simple outil qu’on dé-zippe quelque part et qu’on laisser tel quel. De réels efforts doivent être fait pour former les équipes de productions à l’utilisation et à la configuration de tels outils. Une bonne solution est de les faire participer aux tests de performances de l’application. On complétera cette prise en main par une formation adaptée aux problématiques de production (Déploiement, Monitoring, Sécurité, Backup, Restore, Logs, Tunning, etc&hellip;)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/02/20/Tunning-de-la-JVM/">Tunning De La JVM</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-20T00:00:00+01:00" pubdate data-updated="true">20/02/12</time>
        
         | <a href="/blog/2012/02/20/Tunning-de-la-JVM/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Le 17 janvier 2012 avait lieu une soirée au Lyon JUG ayant pour thème la performance des serveurs en java. Le speaker Ludovic Poitou est un ancien de chez Sun qui a quitté la société suite au rachat par Oracle.</p>

<p>Sa présentation était originale, car contrairement à beaucoup d’entre nous, son logiciel <a href="http://forgerock.com/opendj.html">Open DJ</a> ne tourne pas sur un serveur d’application mais en standalone.</p>

<p>Après une présentation détaillée de sa société, j’ai beaucoup aimé l’explication de la gestion de la mémoire de la JVM. J’avoue que c’est un sujet sur lequel je me suis peu penché car les applications sur lesquelles je travaille n’ont pas le même niveau d’exigence que c’est fixé l’équipe d’Open DJ. L’application la plus “chargée” sur laquelle j’ai travaillé répondait sans broncher à 400 requêtes/seconde HTTP en pointe sur un seul serveur, ce qui est déjà un score honorable sur un serveur d’application d’il y a 5 ans. Mais je ne joue pas dans la même cour, le serveur Open DJ monte à plus de 80000 requêtes/seconde, 200 fois plus de charge.</p>

<p>Pour arriver à ce niveau de performance, il faut avoir une très bonne connaissance du fonctionnement de la JVM, et notamment de la gestion de sa mémoire. Open DJ utilise également une base donnée simple et embarquée : <a href="http://www.oracle.com/technetwork/database/berkeleydb/overview/index.html">Berkeley DB</a></p>

<p>Je vous invite à relire la présentation disponible via le site du Lyon JUG (<a href="http://www.lyonjug.org/evenements/perf-serveur">ici</a>).</p>

<p>Suite à cette présentation je me suis penché sur les paramètres qu’on utilisait pour faire tourner notre JBoss en production. On avait optimisé les options de la JVM de manière un peu empirique, en s’appuyant sur des morceaux de configuration qu’on avait récupéré à travers différents blogs et aussi suite à de nombreuses campagnes de test.
Voilà ce que nous utilisons en production:</p>

<ul>
<li>-d64 : pour faire fonctionner la JVM en 64 bits, et donc adresser au delà de 4Go</li>
<li>-Xms8192m, pour réserver au minimum 8Go de Mémoire vive. C’est une stratégie défensive pour être sur que notre JVM ne se fera pas “piquer” la mémoire par d’autres applications.</li>
<li>-Xmx8192m, pour ne pas dépasser ces fameux 8Go et donc laisser de l’espace aux autres applications tournant sur le serveur.</li>
<li>-XX:MaxPermSize=512m, l’espace la mémoire de type Permanent Generation contient toute les données statiques de la JVM. Il faut qu’il soit suffisamment grand mais pas démesuré. 512 Go est un bon chiffre pour les applications allouant au delà de 8Go de mémoire, il peut être réduit à moins pour les applications plus petite. Il est extrêmement rare d’allouer au delà de 512Mo (jamais vu de mon coté)</li>
<li>-Djava.awt.headless=true, l’option classique pour les serveurs Unix n’ayant pas de serveur X installé</li>
<li>-Dorg.jboss.resolver.warning=true, c’est une option qui était déjà présente. On l’a laissée.</li>
<li>-Dsun.rmi.dgc.client.gcInterval=3600000, c’est une option qui permet de donner la fréquence de garbage collection. En l&#8217;occurrence ça ne sert à rien car nous lui avons donné la valeur par défaut.</li>
<li>-XX:+UseParNewGC, cette option permet de gérer la copie des objets dans la portion de mémoire à plus long terme de manière “multi-threadée” en profitant de la puissance des machines multi-cpu (ce qui est notre cas)</li>
<li>-XX:+AggressiveOpts, je pense que cette option est aussi inutile dans le sens ou elle est devenue activé par défaut depuis la version du JRE 1.5_06. Elle permet d’activer des flags de compilation plus performant.</li>
<li>-XX:+DoEscapeAnalysis, c’est un flag qui permet à la JVM d’optimiser les locks sur l’application, plus d’explication <a href="http://blog.xebia.com/2007/12/21/did-escape-analysis-escape-from-java-6/">ici</a></li>
<li>-XX:+UseLargePages, option permettant d’allouer de gros espaces mémoire, pour plus de détail aller voir <a href="http://www.oracle.com/technetwork/java/javase/tech/largememory-jsp-137182.html">ici</a></li>
<li>-XX:+UseTLAB, option permettant à chaque thread d’allouer sa propre mémoire. C’est une option à activer sur les systèmes multi-processeurs.</li>
<li>-XX:TLABSize=64k, cette option spécifie la taille de la young generation pour chaque thread.</li>
</ul>


<p>Pour compléter ce petit billet, voilà 2 liens utiles</p>

<ul>
<li>la <a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html">documentation</a> officielle de la commande java</li>
<li>un <a href="http://www.datadisk.co.uk/html_docs/java_app/jboss5/jboss5_tuning.htm">blog</a> qui nous avait bien aidé</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2012/01/12/Gestion-des-performances/">Gestion Des Performances</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-12T00:00:00+01:00" pubdate data-updated="true">12/01/12</time>
        
         | <a href="/blog/2012/01/12/Gestion-des-performances/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Je travaille depuis maintenant 2 ans sur un très gros projet qui gère des dizaines de millions d&#8217;utilisateurs. Notre logiciel est donc très sensible à la charge et à toutes améliorations de performance. Voilà une petite liste d&#8217;actions qui permettent de traquer ou de prévenir les problèmes de performances en général.</p>

<h2>Prévention</h2>

<h3>Simplification</h3>

<p>De manière général plus un traitement est simple, plus il est performant. Il faut donc rechercher dans le design la façon de faire la plus simple.
En bonne pratique il faut:</p>

<ul>
<li>ne pas multiplier les couches d&#8217;abstraction. Plus on multiplie les intermédiaires, moins on est réactif.</li>
<li>ne pas multiplier l&#8217;utilisation de librairies techniques (construire de gros échafaudages de librairie). On prend le risque de rendre une fonctionnalité simple beaucoup plus compliquée.</li>
<li>utiliser des environnements maitrisés. Utiliser les dernières technologies c&#8217;est super, mais si on ne maitrise pas tous les impacts, on peut construire de vraies bombes à retardement.</li>
</ul>


<h3>Faire des tests de performance</h3>

<p>Sur notre projet nous avons utilisé JMeter pour simuler du trafic. Attention on ne doit pas seulement faire un hit sur de 2-3 pages mais réaliser un scénario complet et dynamisé.
Par la suite les tests doivent se dérouler sur plusieurs heures ou jours pour voir si la plateforme est stable dans le temps.
Pendant ces tests il ne faut pas forcément essayer de trouver les limites de l&#8217;application mais la soumettre à un stress nominal.
Les tests aux limites sont intéressants mais uniquement si la plate-forme répond correctement au stress nominal.</p>

<h3>Dimensionner l&#8217;infrastructure, limiter la charge</h3>

<p>A partir des tests établis précédemment on peut en déduire des infrastructures cibles.
On ne va pas mettre la même infrastructure chez un client ayant 2 millions de comptes que chez un client ayant 80 millions de comptes.
Il est important de définir ces infrastructures dans les contrats quand on vend le logiciel.
De plus il est important pour les applications critiques de mettre en place des mécanismes de protection pour éviter la saturation de la plate-forme.
On peut par exemple mettre en place un système de licence qui limite le nombre d&#8217;utilisateurs à 10 millions et/ou à un certain nombre de requêtes HTTP par seconde.
Avec cela on garantit le service pour la charge que l&#8217;on a défini contractuellement. Il faudra bien sur penser à ce système dès la conception du logiciel.</p>

<h2>Corrections</h2>

<p>Au niveau développement voilà un certain nombre d&#8217;éléments permettant de traquer les problèmes.</p>

<h3>Optimisation SQL</h3>

<p>De manière générale le tout premier élément limitant d&#8217;un logiciel sur un serveur est la base de données mal utilisée. Il peut y avoir plusieurs causes:</p>

<ul>
<li>mauvais modèle de données</li>
<li>pas d&#8217;index</li>
<li>trop de requêtes SQL</li>
<li>requêtes SQL non optimisées</li>
<li>non maitrise du Framework technique accédant à la base</li>
</ul>


<p>Dans un premier temps, il va falloir tracer les requêtes SQL générées par l&#8217;application. Si vous utilisez Hibernate, vous pouvez par exemple mettre à true le paramètre hibernate.show_sql.
Par la suite vous allez exécuter un scenario de test unitaire sur votre application. Cela va vous permettre d&#8217;identifier les requêtes SQL exécutées à chaque étape de votre scénario.
Des actions doivent être prises si:</p>

<ul>
<li>une même requête est exécutée plusieurs fois pour une étape donnée</li>
<li>une ou plusieurs requêtes inattendues apparaissent (par exemple un delete et des insert alors qu&#8217;on fait un simple select, si si c&#8217;est possible voir [[www.yonita.com/2011_11_16_PERFORMANCE_ANTIPATTERNS_DEVOXX.pdf|ici]])
Ils faut impérativement rester maitre des requêtes faites vers la base de données.</li>
</ul>


<p>Dans un deuxième temps il fait traquer les requêtes consommatrices de ressources. Sur Oracle, on peut utiliser l&#8217;outil Oracle Enterprise Manager qui est une console d&#8217;administration Web de la base de données.
Cet outil permet de monitorer en temps réel la charge de la base de donnée mais aussi d&#8217;avoir la liste des requêtes les plus consommatrices. Un fois ces requêtes identifiées on pourra les optimiser en:</p>

<ul>
<li>ajoutant des index</li>
<li>ajoutant des hints pour l&#8217;optimiseur SQL (les hints sont tout à fait compatible avec des outils comme Hibernate)</li>
<li>en repensant une partie du modèle de base de données pour l&#8217;optimiser</li>
</ul>


<p>Enfin une des dernières optimisations au niveau base de données est de bien préparer la base.
Si le modèle a un impact très fort sur les performances, il ne faut pas négliger la configuration de la base.
Il faut notamment travailler avec un DBA pour optimiser (pour Oracle) la taille des blocs, des redo-logs, des archives-logs.
Attention toutefois à ne pas faire n&#8217;importe quoi, si vous ne maitrisez  pas ces paramètres, n&#8217;y touchez pas.</p>

<h3>Optimisation des Objets/Mémoire/Threads</h3>

<p>Ce paragraphe s&#8217;intéresse à l&#8217;étude et l&#8217;optimisation du code java.</p>

<p>L&#8217;utilitaire jmap permet d&#8217;avoir plus d&#8217;information sur l&#8217;utilisation de la mémoire et des objets. Cet outil est utile pour monitorer la JVM quand elle est stressée de manière normale.</p>

<ul>
<li>jmap -d64 -heap <pid> > heap.txt

<ul>
<li>cette commande permet d&#8217;avoir un état détaillé de la mémoire. Cela vous permettra d&#8217;ajuster les paramètres mémoires de la JVM.</li>
</ul>
</li>
<li>jmap -d64 -histo:live <pid> > histo.txt

<ul>
<li>cette commande permet d&#8217;avoir la liste de toutes les instances tournant dans la JVM. On pourra détecter un trop grand nombre d&#8217;instance pour un type d&#8217;objet.</li>
</ul>
</li>
</ul>


<p>Les applications JEE sont multi-threadés, les threads sont cachés par les APIs de haut niveau de la norme JEE (Servlet, EJB).
Si c&#8217;est API sont mal utilisées, des problèmes de performance apparaissent (notamment des cas d&#8217;inter-blocage).
Pour s&#8217;assurer que notre application n&#8217;est pas dans ce cas, il faut la soumettre à sa charge nominale grâce à des injecteurs ou des outils comme JMeter.
Une fois que l&#8217;application est en cours de fonctionnement, on va faire des Threads Dump de manière régulière pour vérifier qu&#8217;aucun thread n&#8217;est bloqué.
La résolution des cas d&#8217;inter-blocage en changeant l&#8217;implémentation d&#8217;une méthode a souvent des résultats spectaculaires.
A noter que les threads dump en Java se font en envoyant SIGQUIT au process à l&#8217;aide de la commande kill -3 &lt;process_id>.
Sous JBoss on peut faire ça via la console JMX sur le bean ServerInfo.</p>

<p>Une des dernières techniques pour voir plus claire dans le fonctionnement d&#8217;une application. Personnellement j&#8217;ai rarement progressé en profilant une application.
De nombreux outils existent pour profiler une application, cependant un profiler est livré avec le JDK: HPROF. Il peut fonctionner en mode classique (on enregistre tous les évènements) ou en mode sampling (on prend un photo de la JVM toutes les minutes par exemple).
Si on travaille sur environnement stressé, il est préférable d&#8217;utiliser le mode Sampling.</p>

<p>Voilà, c&#8217;était un petit aperçu des différentes techniques que j&#8217;utilise pour améliorer les performances de mes applications. Il en existe certainement bien d&#8217;autres mais celles-ci nous ont bien aidé pour avoir une application performante en production.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header class="page-header">
    
      <h1 class="entry-title"><a href="/blog/2011/07/07/Cloud-Synthese/">Cloud Synth&egrave;se</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-07T00:00:00+02:00" pubdate data-updated="true">07/07/11</time>
        
         | <a href="/blog/2011/07/07/Cloud-Synthese/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Le 9 et 10 juin j&#8217;ai eu la chance de participer à synthèse sur les technologies du Cloud.</p>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/7f/Cirrocumulus_to_Altocumulus.JPG/800px-Cirrocumulus_to_Altocumulus.JPG" alt="source http://commons.wikimedia.org/" /></p>

<p>Voilà mes notes.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2011/07/07/Cloud-Synthese/">Lire la suite&rarr;</a>
    </footer>
  


    </article>
  
  <ul class="pager">
    
    <li class="previous"><a href="/blog/page/2/">&larr; Older</a></li>
    
    <li><a href="/blog/archives">Blog Archives</a></li>
    
  </ul>
</div>
<aside class="sidebar-nav span3">
  
    <section class="aside" >
	<h4>&Agrave; propos</h4>
	<img src="/images/evidal_200.png" class="picid"> Je suis architecte chez <a href="http://www.sicap.com">Sicap</a>. Passionné par mon métier et les nouvelles technologies, ce blog me sert de bloc-notes pour partager certaines découvertes.
	<ul class="social">
		<li><a title="Twitter" href="http://twitter.com/#!/EricVidalPro"><i class="icon-twitter"></i></a></li>
        <li><a title="Linkedin" href="http://www.linkedin.com/pub/eric-vidal/4/582/99"><i class="icon-linkedin"></i></a></li>
        <li><a title="Viadeo" href="http://www.viadeo.com/fr/profile/eric.vidal"><i class="icon-viadeo"></i></a></li>
        <li><a title="Github" href="https://github.com/evidal"><i class="icon-github"></i></a></li>
        <li><a title="RSS" href="/blog/eric-vidal.rss"><i class="icon-rss"></i></a></li>
    </ul>
</section>	<section class="aside">
	<h4>R&eacute;cemment post&eacute;s</h4>
  <ul id="recent_posts" class="nav nav-list">
    
      <li class="post">
        <a href="/blog/2013/02/24/angular.js-et-yeoman/">Angular.js et Yeoman</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/24/mon-premier-sprite-en-HTML-5/">Mon premier sprite en HTML 5</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/18/elastic-search/">Elastic Search</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/24/sophisme-et-spring/">Sophisme et Spring</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/07/Groovy-2.0-Quoi-de-neuf-doc/">Groovy 2.0 : Quoi de neuf doc</a>
      </li>
    
  </ul>
</section>
<section class="aside">
	<h4>Tags</h4>
	<div id="cloud">
		
	        <a href="/blog/categories/blog/" rel="1">blog</a>
		
	        <a href="/blog/categories/conf/" rel="4">conf</a>
		
	        <a href="/blog/categories/java/" rel="6">java</a>
		
	        <a href="/blog/categories/cloud/" rel="1">cloud</a>
		
	        <a href="/blog/categories/perf/" rel="3">perf</a>
		
	        <a href="/blog/categories/groovy/" rel="1">groovy</a>
		
	        <a href="/blog/categories/jee/" rel="1">jee</a>
		
	        <a href="/blog/categories/elastic search/" rel="1">elastic search</a>
		
	        <a href="/blog/categories/html5/" rel="1">html5</a>
		
	        <a href="/blog/categories/javascript/" rel="1">javascript</a>
		
	</div>
</section>	
  
</aside>

	    </div>
	    <footer role="contentinfo" class="page-footer"><div class="footer">
	<div class="container">
	  Copyright &copy; 2013 - Eric Vidal -
	  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
	</div>
</div>
</footer>
	  </div>	  
  </div>  
  

<script type="text/javascript">
      var disqus_shortname = 'ericvidalblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script type="text/javascript" src="/javascripts/jquery.tagcloud.js"></script>
<script type="text/javascript">
	$.fn.tagcloud.defaults = {
	  size: {start: 10, end: 20, unit: 'pt'},
	  color: {start: '#5C7270', end: '#FF7530'}
	};

	$(function () {
		console.log("coucou")
	  $('#cloud a').tagcloud();
	});
</script>



</body>
</html>
<script language="javascript">
	$.backstretch("http://unsplash.s3.amazonaws.com/batch%204/jet-sky.jpg");
</script>